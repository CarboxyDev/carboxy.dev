---
import { GithubIcon } from '@/components/icons/social-icons';
import ImageLightbox from '@/components/ImageLightbox.astro';
import { getFeaturedProjects } from '@/lib/config/projects';
import { cn } from '@/lib/utils';
import { ExternalLink } from 'lucide-react';

const projects = getFeaturedProjects();
---

<section id="projects" class="flex flex-col pt-20 lg:pt-32">
  <h2 class="text-2xl font-semibold tracking-tight text-foreground md:text-3xl font-heading">
    Projects
  </h2>

  <div class="mt-12">
    <div class="flex flex-col gap-y-16 lg:gap-y-24">
      {projects.map((project, index) => {
        const align = index % 2 === 0 ? 'left' : 'right';

        return (
          <article
            class={cn(
              'flex flex-col gap-8 lg:gap-12',
              align === 'left' ? 'lg:flex-row' : 'lg:flex-row-reverse'
            )}
          >
            <div
              class={cn(
                'flex-1 space-y-4',
                align === 'left' ? 'lg:mr-8' : 'lg:ml-8'
              )}
            >
              <h3 class="group text-xl font-semibold text-foreground lg:text-2xl">
                <a
                  href={project.href}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="inline-flex items-center gap-2 transition-colors hover:text-primary"
                >
                  {project.title}
                  <ExternalLink className="h-4 w-4 opacity-0 transition-opacity group-hover:opacity-100" />
                </a>
              </h3>

              <p class="max-w-lg text-muted-foreground">{project.description}</p>

              <div class="flex flex-wrap gap-2 pt-2">
                {project.techStack.map((tech) => (
                  <span class="inline-flex items-center rounded-md border border-border bg-muted px-2.5 py-1 text-xs font-medium text-muted-foreground">
                    {tech}
                  </span>
                ))}
              </div>

              <div class="flex gap-3 pt-4">
                <a
                  href={project.href}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="inline-flex h-10 items-center gap-2 rounded-md bg-primary px-4 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90"
                >
                  <ExternalLink className="h-4 w-4" />
                  <span>View Project</span>
                </a>
                {project.github && (
                  <a
                    href={project.github}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="inline-flex h-10 items-center gap-2 rounded-md border border-border bg-background px-4 text-sm font-medium text-foreground transition-colors hover:bg-accent"
                  >
                    <GithubIcon className="h-4 w-4" />
                    <span>Code</span>
                  </a>
                )}
              </div>
            </div>

            <div class="max-w-2xl flex-1">
              <ImageLightbox
                images={project.images}
                alt={`${project.title} preview`}
              />
            </div>
          </article>
        );
      })}
    </div>
  </div>
</section>
