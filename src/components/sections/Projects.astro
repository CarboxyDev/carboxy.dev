---
import { GithubIcon } from '@/components/icons/social-icons';
import ImageLightbox from '@/components/ImageLightbox.astro';
import { getFeaturedProjects } from '@/lib/config/projects';
import { cn } from '@/lib/utils';
import { ExternalLink } from 'lucide-react';

const projects = getFeaturedProjects();
---

<section id="projects" class="flex flex-col pt-20 lg:pt-32">
  <h2 class="text-2xl font-semibold tracking-tight text-foreground md:text-3xl font-heading">
    Projects
  </h2>

  <div class="mt-12">
    <div class="flex flex-col gap-y-20 lg:gap-y-28">
      {projects.map((project, index) => {
        const align = index % 2 === 0 ? 'left' : 'right';

        return (
          <article
            class={cn(
              'group/card flex flex-col gap-8 lg:gap-12',
              align === 'left' ? 'lg:flex-row' : 'lg:flex-row-reverse'
            )}
          >
            <div
              class={cn(
                'flex-1 space-y-4',
                align === 'left' ? 'lg:mr-4' : 'lg:ml-4'
              )}
            >
              <div class="flex items-center gap-3">
                <span class="inline-flex items-center rounded-full border border-border bg-card/50 px-2.5 py-0.5 text-xs font-medium text-muted-foreground">
                  {project.type}
                </span>
              </div>

              <h3 class="group text-xl font-semibold text-foreground lg:text-2xl">
                <a
                  href={project.href}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="inline-flex items-center gap-2 transition-colors hover:text-muted-foreground"
                >
                  {project.title}
                  <ExternalLink className="h-4 w-4 opacity-0 transition-all duration-200 group-hover:opacity-100 group-hover:translate-x-0.5" />
                </a>
              </h3>

              <p class="max-w-lg text-muted-foreground leading-relaxed">{project.description}</p>

              <p class="pt-2 text-sm text-muted-foreground/80">
                {project.techStack.join(' Â· ')}
              </p>

              <div class="flex items-center gap-3 pt-4">
                <a
                  href={project.href}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="inline-flex h-9 items-center gap-2 rounded-lg bg-primary px-4 text-sm font-medium text-primary-foreground transition-all duration-200 hover:bg-primary/90 hover:scale-[1.02]"
                >
                  View Project
                </a>
                {project.github && (
                  <a
                    href={project.github}
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label="View source code"
                    class="inline-flex h-9 w-9 items-center justify-center rounded-lg text-muted-foreground transition-all duration-200 hover:bg-accent hover:text-foreground hover:scale-105"
                  >
                    <GithubIcon className="h-5 w-5" />
                  </a>
                )}
              </div>
            </div>

            <div class="w-full lg:w-[50%] lg:shrink-0">
              <div class="overflow-hidden rounded-xl border border-border/50 bg-card/30 transition-all duration-300 group-hover/card:border-border group-hover/card:shadow-lg group-hover/card:shadow-black/5">
                <ImageLightbox
                  images={project.images}
                  alt={`${project.title} preview`}
                />
              </div>
            </div>
          </article>
        );
      })}
    </div>
  </div>
</section>
